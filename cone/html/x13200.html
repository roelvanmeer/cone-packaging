<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><link rel='stylesheet' type='text/css' href='manpage.css'>
<!-- $Id: book.sgml,v 1.3 2004/05/30 02:43:00 mrsam Exp $ -->
<!-- Copyright 2002-2003 Double Precision, Inc.  See COPYING for -->
<!-- distribution information. -->
<meta name="MSSmartTagsPreventParsing" content="TRUE">
<link rel="icon" href="icon.gif" type="image/gif" />
<TITLE
>Reading message contents</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
HREF="book.html"><LINK
REL="UP"
TITLE="Simple Mail Access Protocol, Version 1"
HREF="smap1.html"><LINK
REL="PREVIOUS"
TITLE="Reading message attributes"
HREF="attributes.html"><LINK
REL="NEXT"
TITLE="Modifying message attributes"
HREF="store.html"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="attributes.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Simple Mail Access Protocol, Version 1</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="store.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="AEN13200"
>Reading message contents</A
></H1
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS=BODY<br>
S:&nbsp;{.7160}&nbsp;FETCH&nbsp;1&nbsp;CONTENTS<br>
S:<br>
S:&nbsp;Hello,<br>
S:<br>
S:&nbsp;There&nbsp;will&nbsp;be&nbsp;a&nbsp;meeting&nbsp;tomorrow.<br>
S:<br>
S:<I
CLASS="EMPHASIS"
>...</I
><br>
S:<br>
S:&nbsp;.<br>
S:&nbsp;*&nbsp;FETCH&nbsp;1&nbsp;FLAGS=<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
><P
>There are additional
<TT
CLASS="LITERAL"
>FETCH</TT
> keywords that instruct the server to retrieve
the actual message contents.
These keywords, described in the
following sections, may be requested at the same time
as the attribute keywords specified in the previous section.
The server will respond with both single-line replies that contain the
attributes, and multi-line replies that contain the requested message content.
As always, the server may send the
individual replies in any order.</P
><P
>The <TT
CLASS="LITERAL"
>CONTENTS=</TT
><TT
CLASS="REPLACEABLE"
><I
>part</I
></TT
>
keyword results in a
<A
HREF="x12387.html#SINGLELINE"
>multiple line</A
> reply from the server,
returning the requested content, specified by <TT
CLASS="REPLACEABLE"
><I
>part</I
></TT
>.
The server may use either multiple line format (dot-stuffed, or binary)
at its discretion.
The server may use either the <TT
CLASS="LITERAL"
>LF</TT
> or the
<TT
CLASS="LITERAL"
>CRLF</TT
>
sequence to terminate lines.
The server automatically sets the <TT
CLASS="LITERAL"
>SEEN</TT
> flag on this
message, which SHOULD generate an additional single line
<TT
CLASS="LITERAL"
>* FETCH</TT
> reply from the server.</P
><P
>Using <TT
CLASS="LITERAL"
>CONTENTS.PEEK</TT
> instead of <TT
CLASS="LITERAL"
>CONTENTS</TT
>
does not set the <TT
CLASS="LITERAL"
>SEEN</TT
> flag.
The following documentation refers only to <TT
CLASS="LITERAL"
>CONTENTS</TT
>, but
either one may be used; they are identical to each other in all ways except
for the <TT
CLASS="LITERAL"
>SEEN</TT
> flag.</P
><P
><TT
CLASS="REPLACEABLE"
><I
>part</I
></TT
> should be a keyword
chosen from the following list:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="LITERAL"
>HEADERS(</TT
><TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
><TT
CLASS="LITERAL"
>)</TT
></DT
><DD
><P
>Returns only the header portion of the message.
<TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
> is a comma-separated list of
case-insensitive header names.
The list may be empty, in which case all the headers
are returned; otherwise only the specified headers are returned, if they
are present.
<TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
> may also contain the following keywords
which are a shorthand representation for frequently requested headers:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="LITERAL"
>:ENVELOPE</TT
></DT
><DD
><P
>This is the same as <SPAN
CLASS="QUOTE"
>"DATE,SUBJECT,FROM,SENDER,REPLY-TO,TO,CC,BCC,IN-REPLY-TO,MESSAGE-ID,REFERENCES"</SPAN
>.</P
></DD
><DT
><TT
CLASS="LITERAL"
>:MIME</TT
></DT
><DD
><P
>This is the same as <SPAN
CLASS="QUOTE"
>":ENVELOPE"</SPAN
>, plus <SPAN
CLASS="QUOTE"
>"MIME-VERSION"</SPAN
>
and all headers that start with <SPAN
CLASS="QUOTE"
>"CONTENT-"</SPAN
>.</P
></DD
></DL
></DIV
><P
>In all cases, folded header lines are automatically unfolded by the server.
All folding newline characters, and the leading whitespace on the continuation
lines, are replaced by a single space character. Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS.PEEK=HEADERS(FROM,MIME-VERSION,CONTENT-TYPE)<br>
S:&nbsp;{.300}&nbsp;FETCH&nbsp;1&nbsp;HEADERS<br>
S:&nbsp;Mime-Version:&nbsp;1.0<br>
S:&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=iso-8859-1<br>
S:&nbsp;From:&nbsp;Tom&nbsp;Jones&nbsp;&#60;tjones@example.com&#62;<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
><P
>Another example:</P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS.PEEK=HEADERS(:ENVELOPE)<br>
S:&nbsp;{.300}&nbsp;FETCH&nbsp;1&nbsp;HEADERS<br>
S:&nbsp;From:&nbsp;Tom&nbsp;Jones&nbsp;&#60;tjones@example.com&#62;<br>
S:&nbsp;To:&nbsp;Bob&nbsp;Smith&nbsp;&#60;bsmith@example.com&#62;<br>
S:&nbsp;Subject:&nbsp;Meeting<br>
S:&nbsp;Message-ID:&nbsp;&#60;802374jekdj90@example.com&#62;<br>
S:&nbsp;Date:&nbsp;Mon,&nbsp;21&nbsp;Apr&nbsp;2002&nbsp;16:56:11&nbsp;-0400<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></DD
><DT
><TT
CLASS="LITERAL"
>MIME(</TT
><TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
><TT
CLASS="LITERAL"
>)</TT
></DT
><DD
><P
>Returns the header portion of all MIME sections in the message.
<TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
> is a comma-separated list of
case-insensitive header names, as in the <TT
CLASS="LITERAL"
>HEADER</TT
> keyword.
Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS.PEEK=MIME(MIME-VERSION,CONTENT-TYPE,CONTENT-TRANSFER-ENCODING)<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;LINES=207&nbsp;SIZE=3120&nbsp;MIME.ID=<br>
S:&nbsp;Mime-Version:&nbsp;1.0<br>
S:&nbsp;Content-Type:&nbsp;multipart/mixed;&nbsp;boundary="0123456789ABCDEF"<br>
S:&nbsp;.<br>
S:&nbsp;{.40}&nbsp;FETCH&nbsp;1&nbsp;LINES=185&nbsp;SIZE=1012&nbsp;MIME.ID=1&nbsp;MIME.PARENT=<br>
S:&nbsp;Content-Type:&nbsp;multipart/alternative;&nbsp;boundary="ABCDEF0123456789"<br>
S:&nbsp;.<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;LINES=81&nbsp;SIZE=208&nbsp;"MIME.ID=1&nbsp;1"&nbsp;MIME.PARENT=1<br>
S:&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=iso-8859-1<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;quoted-printable<br>
S:&nbsp;.<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;LINES=42&nbsp;SIZE=783&nbsp;"MIME.ID=1&nbsp;2"&nbsp;MIME.PARENT=1<br>
S:&nbsp;Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;quoted-printable<br>
S:&nbsp;.<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;LINES=50&nbsp;SIZE=1257&nbsp;MIME.ID=2&nbsp;MIME.PARENT=<br>
S:&nbsp;Content-Type:&nbsp;image/gif<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;base64<br>
S:&nbsp;.<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;LINES=45&nbsp;SIZE=907&nbsp;MIME.ID=3&nbsp;MIME.PARENT=<br>
S:&nbsp;Content-Type:&nbsp;message/rfc822<br>
S:&nbsp;.<br>
S:&nbsp;{.120}&nbsp;FETCH&nbsp;1&nbsp;LINES=27&nbsp;SIZE=452&nbsp;"MIME.ID=3&nbsp;1"&nbsp;MIME.PARENT=3<br>
S:&nbsp;Mime-Version:&nbsp;1.0<br>
S:&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=iso-8859-1<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;8bit<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
><P
><A
HREF="http://www.rfc-editor.org/rfc/rfc2045.txt"
TARGET="_top"
>RFC 2045</A
>,
and related documents,
specifies the format of MIME messages.
A MIME message contains one or more individual or multipart
MIME sections; a multipart MIME section
itself contains inferior individual or multipart sections, forming a
distinct hierarchy.
Consult RFCs 2045 through 2049 for additional information.</P
><P
><TT
CLASS="LITERAL"
>MIME(</TT
><TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
><TT
CLASS="LITERAL"
>)</TT
>
parses the MIME structure of a message, and recursively returns the requested
headers from each MIME section in the message.
The server returns a series of <A
HREF="x12387.html#MULTILINE"
>multi-line</A
>
replies, each reply carries headers from a single MIME section.
The multi-line replies may be sent in any order, except that the headers
for the topmost MIME section must always be sent first, and the headers from
the other MIME sections may only be sent after the headers from their parent
MIME section, and the headers from all of
their preceding sibling MIME section
(which is just a fancy way of saying that the server
uses either the prefix or the infix traversal order).</P
><P
>The server assigns a
unique <SPAN
CLASS="QUOTE"
>"MIME section ID"</SPAN
> to each MIME section.
The method the server uses to generate a MIME section ID is entirely up to
the server, with one exception:
the MIME section ID for the entire message must
be an empty string.
SMAP clients should treat MIME section ID as opaque text strings, and must
not interpret them in any way (except for the blank mime ID referring to the
entire message).</P
><P
><SPAN
CLASS="QUOTE"
>"<TT
CLASS="LITERAL"
>MIME.ID=</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
>"</SPAN
>
specifies the MIME section ID of the following headers.
<SPAN
CLASS="QUOTE"
>"<TT
CLASS="LITERAL"
>MIME.PARENT=</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
>"</SPAN
>
specifies the MIME section ID of the parent MIME section (this attribute
is not specified for the topmost MIME section, which has no parent).
<SPAN
CLASS="QUOTE"
>"<TT
CLASS="LITERAL"
>MIME.PARENT=</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
>"</SPAN
>
is not returned for the first, topmost MIME section, and since its
MIME section ID is always an empty string, its inferior MIME section
will have <SPAN
CLASS="QUOTE"
>"<TT
CLASS="LITERAL"
>MIME.PARENT=</TT
>"</SPAN
>,
the empty <TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
> referring to the topmost MIME
section.</P
><P
>The SMAP client uses this information to reconstruct the structure of the
MIME message.</P
><P
>The above example shows a MIME <TT
CLASS="LITERAL"
>multipart/mixed</TT
> message
with three sections.
The first section is a MIME <TT
CLASS="LITERAL"
>multipart/alternative</TT
> with
two subsections: <TT
CLASS="LITERAL"
>text/plain</TT
> and
<TT
CLASS="LITERAL"
>text/html</TT
>.
The second section is an <TT
CLASS="LITERAL"
>image/gif</TT
>, and the third section
is a
<TT
CLASS="LITERAL"
>message/rfc822</TT
>.</P
><P
><TT
CLASS="LITERAL"
>message/rfc822</TT
> MIME sections are parsed as
multipart sections, with exactly one
component section: the attached message.
The above example shows that the attached message consists of a single
<TT
CLASS="LITERAL"
>text/plain</TT
> section.</P
><DIV
CLASS="NOTE"
><P
></P
><TABLE
CLASS="NOTE"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
>NOTE:</TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>The <TT
CLASS="LITERAL"
>MIME.ID</TT
>, <TT
CLASS="LITERAL"
>MIME.PARENT</TT
>,
<TT
CLASS="LITERAL"
>SIZE</TT
>
and <TT
CLASS="LITERAL"
>LINES</TT
>
values may occur in any order.
<TT
CLASS="LITERAL"
>SIZE</TT
> gives an estimated size of the content portion
of the MIME section, and
<TT
CLASS="LITERAL"
>LINES</TT
>
gives the approximate number of text lines in the content portion of the
MIME section.
These numbers are not to be taken as exact counts, but as ballpark
estimates.</P
></TD
></TR
></TABLE
></DIV
></DD
><DT
><TT
CLASS="LITERAL"
>HEADERS[</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
><TT
CLASS="LITERAL"
>](</TT
><TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
><TT
CLASS="LITERAL"
>)</TT
></DT
><DD
><P
>This is the same as
<TT
CLASS="LITERAL"
>HEADERS(</TT
><TT
CLASS="REPLACEABLE"
><I
>list</I
></TT
><TT
CLASS="LITERAL"
>)</TT
>,
except that the server returns headers from the MIME section specified by
<TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
>.  Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;"CONTENTS.PEEK=HEADERS[1&nbsp;2](CONTENT-TYPE,CONTENT-TRANSFER-ENCODING)"<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;HEADERS<br>
S:&nbsp;Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;quoted-printable<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
></DD
><DT
><TT
CLASS="LITERAL"
>BODY</TT
></DT
><DD
><P
>Returns the only the body portion of the message.  Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS=BODY<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;BODY<br>
S:&nbsp;Mary&nbsp;had&nbsp;a&nbsp;little&nbsp;lamb,&nbsp;its&nbsp;fleece&nbsp;was&nbsp;white&nbsp;as&nbsp;snow,<br>
S:&nbsp;and&nbsp;everywhere&nbsp;Mary&nbsp;went,&nbsp;the&nbsp;lamb&nbsp;was&nbsp;sure&nbsp;to&nbsp;go.<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
></DD
><DT
><TT
CLASS="LITERAL"
>BODY[</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
><TT
CLASS="LITERAL"
>]</TT
></DT
><DD
><P
>Returns the only the body portion of the specified
MIME section.  Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;"CONTENTS=BODY[1&nbsp;1]"<br>
S:&nbsp;{.80}&nbsp;FETCH&nbsp;1&nbsp;BODY<br>
S:&nbsp;Itsy-bitsy&nbsp;spider&nbsp;went&nbsp;up&nbsp;the&nbsp;water&nbsp;spout,<br>
S:&nbsp;Down&nbsp;came&nbsp;the&nbsp;rain,&nbsp;and&nbsp;washed&nbsp;the&nbsp;spider&nbsp;out.<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
></DD
><DT
><TT
CLASS="LITERAL"
>ALL</TT
></DT
><DD
><P
>Returns both the headers and the body portion of the message.</P
></DD
><DT
><TT
CLASS="LITERAL"
>ALL[</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
><TT
CLASS="LITERAL"
>]</TT
></DT
><DD
><P
>Returns the headers, a blank line, then the body portion of the specified
MIME section.  Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;"CONTENTS=ALL[1&nbsp;1]"<br>
S:&nbsp;{.120}&nbsp;FETCH&nbsp;1&nbsp;ALL<br>
S:&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=iso-8859-1<br>
S:&nbsp;Content-Transfer-Encoding:&nbsp;7bit<br>
S:<br>
S:&nbsp;Itsy-bitsy&nbsp;spider&nbsp;went&nbsp;up&nbsp;the&nbsp;water&nbsp;spout,<br>
S:&nbsp;Down&nbsp;came&nbsp;the&nbsp;rain,&nbsp;and&nbsp;washed&nbsp;the&nbsp;spider&nbsp;out.<br>
S:&nbsp;.<br>
S:&nbsp;+OK&nbsp;Ok</P
></P
><DIV
CLASS="NOTE"
><P
></P
><TABLE
CLASS="NOTE"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
>NOTE:</TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Unlike <TT
CLASS="LITERAL"
>HEADERS</TT
>, folded header lines are not unfolded
by <TT
CLASS="LITERAL"
>ALL</TT
>.</P
></TD
></TR
></TABLE
></DIV
></DD
><DT
><TT
CLASS="LITERAL"
>BODY.DECODED</TT
></DT
><DD
><P
>Same as <TT
CLASS="LITERAL"
>BODY</TT
> except that the server automatically
decodes the MIME-encoded section, and sends the raw decoded content as
a binary, multi-line reply.  Example:</P
><P
><P
CLASS="LITERALLAYOUT"
>C:&nbsp;FETCH&nbsp;1&nbsp;CONTENTS=BODY.DECODED<br>
S:&nbsp;{322/322}&nbsp;FETCH&nbsp;1&nbsp;BODY.DECODED<br>
S:<br>
S:&nbsp;<I
CLASS="EMPHASIS"
>[ 322 bytes, then a blank line, follows ]</I
><br>
S:&nbsp;+OK&nbsp;Ok.</P
></P
></DD
><DT
><TT
CLASS="LITERAL"
>BODY.DECODED[</TT
><TT
CLASS="REPLACEABLE"
><I
>id</I
></TT
><TT
CLASS="LITERAL"
>]</TT
></DT
><DD
><P
>Return the decoded contents of the indicated MIME section.</P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="attributes.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="store.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Reading message attributes</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="smap1.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Modifying message attributes</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>